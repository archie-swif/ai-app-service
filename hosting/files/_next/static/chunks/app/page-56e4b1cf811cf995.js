(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{7999:function(e,n,t){Promise.resolve().then(t.bind(t,2787))},2787:function(e,n,t){"use strict";t.r(n),t.d(n,{default:function(){return f}});var s=t(7437),a=t(2265),o=t(2178),i=t(3239),c=JSON.parse('[{"role":"system","content":"You are a helpful movie database assistant. Use only information from the provided JSON documents containing details on movies. Each document contains a single movie, and information such as its title, release year, and cast."},{"role":"system","content":"Provide response texts with 500 symbols maximum"}]'),l=JSON.parse('{"temperature":0.5,"model":"gpt-4"}'),r=t(5983);function u(e){let{request:n,onResponse:t,searchContext:o=[],openai:i,model:u,name:d,temperature:m}=e,[p,f]=(0,a.useState)(""),[h,g]=(0,a.useState)(""),[v,y]=(0,a.useState)(c);async function x(e){e.preventDefault(),N(p)}function N(e){e&&""!==e.trim()&&(f(""),g("..."),j(e).then(e=>{g(e),t(d+": "+e)}))}async function j(e){try{let n=[...v,{role:"user",content:e}];console.log(n);let t=i.chat.completions.create({...l,model:u,messages:n,temperature:m}),s=await Promise.race([t,new Promise((e,n)=>{setTimeout(e,6e4,d+": *nods silently*")})]),a=s.choices[0].message;return n.push(a),y(n),a.content}catch(e){return console.error(e),"*confused*"}}return(0,a.useEffect)(()=>N(n),[n]),(0,a.useEffect)(()=>(function(e){let n=[...v,...o];y(n)})(0),[o]),(0,s.jsxs)("div",{className:"command-line",children:[(0,s.jsx)("span",{className:"prompt-icon",hidden:!!p,children:"☺"}),(0,s.jsx)("span",{className:"prompt-icon",hidden:!p,children:"$"}),(0,s.jsx)(r.Z,{rows:1,cols:50,autoCapitalize:"sentences",className:"command-input",placeholder:h,value:p,onChange:function(e){f(e.target.value)},onKeyDown:e=>{"Enter"!==e.key||e.shiftKey||x(e)}})]})}let d=[{$search:{index:"plot_embedding_cosine",knnBeta:{vector:[],path:"plot_embedding",k:10}}},{$project:{_id:0,plot_embedding:0}}];function m(e){let{openai:n,mongoClient:t,onResponse:o}=e,[i,c]=(0,a.useState)(""),[l,u]=(0,a.useState)("");async function m(e){let s=await n.embeddings.create({input:e,model:"text-embedding-ada-002"});return d[0].$search.knnBeta.vector=s.data[0].embedding,t.db("sample_mflix").collection("embedded_movies").aggregate(d)}async function p(e){e.preventDefault(),u("..."),c("");let n=await m(i);o(n);let t=n.map(e=>e.title).join("\n");u(t)}return(0,s.jsxs)("div",{className:"command-line",children:[(0,s.jsx)("span",{className:"prompt-icon",children:"░"}),(0,s.jsx)(r.Z,{rows:1,cols:50,autoCapitalize:"sentences",className:"command-input",autoFocus:!0,placeholder:l,value:i,onChange:function(e){c(e.target.value)},onKeyDown:e=>{"Enter"!==e.key||e.shiftKey||p(e)}})]})}function p(e){let{saveKey:n}=e,[t,o]=(0,a.useState)("");async function i(e){e.preventDefault(),n(t)}return(0,s.jsxs)("div",{className:"command-line",children:[(0,s.jsx)("span",{className:"prompt-icon",children:"☼"}),(0,s.jsx)("form",{onSubmit:i,children:(0,s.jsx)("input",{size:100,type:"password",className:"command-input",autoFocus:!0,placeholder:"OpenAI Key -> Local Storage",onChange:function(e){o(e.target.value)}})})]})}function f(){let[e,n]=(0,a.useState)(""),[t,c]=(0,a.useState)([]),[l,r]=(0,a.useState)(),[d,f]=(0,a.useState)(),[h,g]=(0,a.useState)(localStorage.getItem("OPENAI_KEY")||"");async function v(e){console.log(e);let n=e.map(e=>({role:"user",content:JSON.stringify(e)}));c(n)}async function y(e){console.log(e)}return(0,a.useEffect)(()=>{let e=async()=>{let e=new i.gV({id:"ai-app-service-mxlkl"}),n=await e.logIn(i.cN.anonymous()),t=n.mongoClient("ai-app-service");r(t);let s=new o.ZP({apiKey:h,dangerouslyAllowBrowser:!0});f(s)};h&&e()},[h]),(0,s.jsx)("div",{className:"grid-container",children:(0,s.jsxs)("div",{className:"centered-div",children:[(0,s.jsx)("div",{hidden:!!h,children:(0,s.jsx)(p,{saveKey:e=>{g(e),localStorage.setItem("OPENAI_KEY",e)}})}),(0,s.jsxs)("div",{hidden:!h,children:[(0,s.jsx)(u,{name:"GPT",model:"gpt-4",temperature:.5,request:e,searchContext:t,onResponse:y,openai:d}),(0,s.jsx)(m,{openai:d,mongoClient:l,onResponse:v})]})]})})}}},function(e){e.O(0,[649,981,971,596,744],function(){return e(e.s=7999)}),_N_E=e.O()}]);