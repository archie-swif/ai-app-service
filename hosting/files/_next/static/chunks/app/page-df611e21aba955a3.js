(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{7999:function(e,n,t){Promise.resolve().then(t.bind(t,3069))},3069:function(e,n,t){"use strict";t.r(n),t.d(n,{default:function(){return p}});var s=t(7437),a=t(2178),o=t(2265),i=JSON.parse('[{"role":"system","content":"You are a helpful movie database assistant. Use only information from the provided JSON documents containing details on movies. Each document contains a single movie, and information such as its title, release year, and cast."},{"role":"system","content":"Provide response texts with 500 symbols maximum"}]'),c=JSON.parse('{"temperature":0.5,"model":"gpt-4"}'),l=t(5983);function r(e){let{request:n,onResponse:t,searchContext:a=[],openai:r,model:u,name:m,temperature:d,char:p="☺"}=e,[f,h]=(0,o.useState)(""),[g,y]=(0,o.useState)(""),[v,x]=(0,o.useState)(i);async function N(e){e.preventDefault(),w(f)}function w(e){e&&""!==e.trim()&&(h(""),y("..."),b(e).then(e=>{y(e),t(m+": "+e)}))}async function b(e){try{let n=[...v,{role:"user",content:e}];console.log(n);let t=r.chat.completions.create({...c,model:u,messages:n,temperature:d}),s=await Promise.race([t,new Promise((e,n)=>{setTimeout(e,6e4,m+": *nods silently*")})]),a=s.choices[0].message;return n.push(a),x(n),a.content}catch(e){return console.error(e),"*confused*"}}return(0,o.useEffect)(()=>w(n),[n]),(0,o.useEffect)(()=>(function(e){let n=[...v,...a];x(n)})(0),[a]),(0,s.jsxs)("div",{className:"command-line",children:[(0,s.jsx)("span",{className:"prompt-icon",hidden:!!f,children:p}),(0,s.jsx)("span",{className:"prompt-icon",hidden:!f,children:"$"}),(0,s.jsx)("form",{onSubmit:N,children:(0,s.jsx)(l.Z,{rows:1,cols:50,autoCapitalize:"sentences",className:"command-input",placeholder:g,value:f,onChange:function(e){h(e.target.value)},onKeyDown:e=>{"Enter"!==e.key||e.shiftKey||N(e)}})})]})}let u=[{$search:{index:"plot_embedding_cosine",knnBeta:{vector:[],path:"plot_embedding",k:10}}},{$project:{_id:0,plot_embedding:0}}];function m(e){let{openai:n,mongoClient:t,onResponse:a}=e,[i,c]=(0,o.useState)(""),[r,m]=(0,o.useState)("");async function d(e){let s=await n.embeddings.create({input:e,model:"text-embedding-ada-002"});return u[0].$search.knnBeta.vector=s.data[0].embedding,t.db("sample_mflix").collection("embedded_movies").aggregate(u)}async function p(e){e.preventDefault(),m("..."),c("");let n=await d(i);a(n);let t=n.map(e=>e.title).join("\n");m(t)}return(0,s.jsxs)("div",{className:"command-line",children:[(0,s.jsx)("span",{className:"prompt-icon",children:"░"}),(0,s.jsx)("form",{onSubmit:p,children:(0,s.jsx)(l.Z,{rows:1,cols:50,autoCapitalize:"sentences",className:"command-input",autoFocus:!0,placeholder:r,value:i,onChange:function(e){c(e.target.value)},onKeyDown:e=>{"Enter"!==e.key||e.shiftKey||p(e)}})})]})}var d=t(3239);function p(){let[e,n]=(0,o.useState)(""),[t,i]=(0,o.useState)([]),[c,l]=(0,o.useState)(),[u,p]=(0,o.useState)();async function f(e){console.log(e);let n=e.map(e=>({role:"user",content:JSON.stringify(e)}));i(n)}async function h(e){console.log(e)}return(0,o.useEffect)(()=>{let e=async()=>{let e=new d.gV({id:"ai-app-service-mxlkl"}),n=await e.logIn(d.cN.anonymous()),t=n.mongoClient("ai-app-service");l(t);let s=new a.ZP({apiKey:"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",dangerouslyAllowBrowser:!0});p(s)};e()},[]),(0,s.jsx)("div",{className:"grid-container",children:(0,s.jsxs)("div",{className:"centered-div",children:[(0,s.jsx)(r,{name:"GPT",model:"gpt-4",temperature:.5,request:e,searchContext:t,onResponse:h,openai:u}),(0,s.jsx)(m,{openai:u,mongoClient:c,onResponse:f})]})})}}},function(e){e.O(0,[649,981,971,596,744],function(){return e(e.s=7999)}),_N_E=e.O()}]);